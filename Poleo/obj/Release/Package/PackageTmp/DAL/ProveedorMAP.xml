<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="LineItem"
xmlns="http://ibatis.apache.org/mapping"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >
  <alias>
    <typeAlias alias="Proveedor" type="Poleo.Objects.Proveedor" />
  </alias>

  <statements>
    <insert id="InsertProveedor" parameterClass="Proveedor">
      INSERT INTO Proveedor
      (Nombre,RFC,Vigencia,Cuenta,Activo,Tipo)
      VALUES
      (#Nombre#,#RFC#,#Vigencia#,#Cuenta#,0,#Tipo#)
      <selectKey resultClass="int" type="post" property="IdProveedor" >
        select @@IDENTITY as value
      </selectKey>
    </insert>
    <select id="SelectProveedorbyRFC" parameterClass="Proveedor" resultClass="Proveedor">
      select * from Proveedor 
      <dynamic prepend="WHERE">
        <isNotEmpty prepend="AND" property="RFC" >
          RFC=#RFC#
        </isNotEmpty>
    </dynamic>
    </select>
    <select id="SelectProveedorbyChange" parameterClass="Proveedor" resultClass="Proveedor">
      select * from Proveedor 
      WHERE Activo=0
      <isNotEmpty prepend="AND" property="RFC" >
        RFC=#RFC#
      </isNotEmpty>
    </select>
    <update id="UpdateProveedorActive" parameterClass="Proveedor" >
      update Proveedor
      set
      Activo   = #Activo# ,
      Vigencia = #Vigencia#,
      Cuenta   = #Cuenta#,
      Tipo     = #Tipo#
      where RFC= #RFC# and IdProveedor = #IdProveedor#
    </update>
    <select id="AutoCompleteProveedores" parameterClass="Proveedor"  resultType="string">
      select Nombre from Proveedor WHERE Nombre like #Nombre#
    </select>
  </statements>
</sqlMap> 
