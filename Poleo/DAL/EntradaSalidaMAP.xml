<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="LineItem"
xmlns="http://ibatis.apache.org/mapping"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >
  <alias>
    <typeAlias alias="EntradasSalidas" type="Poleo.Objects.EntradasSalidas" />
    <typeAlias alias="VentasEntradaSalidas" type="Poleo.Objects.VentasFinder" />
  </alias>

  <statements>
    <select id="SelectFacturas" parameterClass="VentasInventario" resultClass="EntradasSalidas">
      SELECT
      InvoiceNumber AS NumeroFactura,
      (Amount+DeliveryCharge) AS Cantidad
      FROM InventoryPurchasesExtracts  P
      inner join Tiendas as T on T.Number_tienda=P.Location_Code
      WHERE System_Date between #DateIni# AND #DateEnd#
      <isNotEmpty prepend="AND" property="NumTienda" >
      Location_Code= #NumTienda#
    </isNotEmpty>
    <isNotEmpty prepend="AND" property="TipoTienda" >
      T.Tipo= #TipoTienda#
    </isNotEmpty>
    <isNotEmpty prepend="AND" property="UbicacionTienda" >
      T.Ubicacion = #UbicacionTienda#
    </isNotEmpty>
      ORDER BY VendorCode  DESC
    </select>
    <select id="SelectTotalFacturas" parameterClass="VentasInventario" resultClass="EntradasSalidas">
      SELECT 
        SUM(Amount+DeliveryCharge) AS TotalFactura 
      FROM InventoryPurchasesExtracts P
      INNER JOIN Tiendas AS T on T.Number_tienda = P.Location_Code
      WHERE System_Date BETWEEN #DateIni# AND #DateEnd#
      <isNotEmpty prepend="AND" property="NumTienda" >
      Location_Code= #NumTienda#
    </isNotEmpty>
    <isNotEmpty prepend="AND" property="TipoTienda" >
      T.Tipo= #TipoTienda#
    </isNotEmpty>
    <isNotEmpty prepend="AND" property="UbicacionTienda" >
      T.Ubicacion = #UbicacionTienda#
    </isNotEmpty>
    </select>
  </statements>
</sqlMap>